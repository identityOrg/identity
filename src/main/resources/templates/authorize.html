<!DOCTYPE html>
<!--
  ~    Copyright 2018 prasenjit-net
  ~
  ~    Licensed under the Apache License, Version 2.0 (the "License");
  ~    you may not use this file except in compliance with the License.
  ~    You may obtain a copy of the License at
  ~
  ~        http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~    Unless required by applicable law or agreed to in writing, software
  ~    distributed under the License is distributed on an "AS IS" BASIS,
  ~    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~    See the License for the specific language governing permissions and
  ~    limitations under the License.
  -->

<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>Authorize Access</title>
</head>
<body>
<!--/*@thymesVar id="model" type="net.prasenjit.identity.model.AuthorizationModel"*/-->
<h1>Client
    <b th:text="${model.client.clientName}"></b> is trying to access your resource</h1>
<h2>If you recognise the activity please approve</h2>
<span th:text="${model.client.clientName}"></span>
will get access to.
<form th:action="${#mvc.url('OAC#submitAuthorize').build()}" th:object="${model}" method="post" name="auth">
    <div th:each="s : *{filteredScopes}">
        <label th:for="${#ids.next('scope')}" th:text="${s.key}"></label>
        <input th:id="${#ids.seq('scope')}" type="checkbox" th:field="*{filteredScopes[__${s.key}__]}">
    </div>
    <div>
        <button type="submit" name="valid" value="true">Approve</button>
        <button type="submit" name="valid" value="false">Disapprove</button>
    </div>
    <input type="hidden" th:field="*{redirectUri}">
    <input type="hidden" th:field="*{state}">
    <input type="hidden" th:field="*{client.clientId}">
    <input type="hidden" th:field="*{responseType}">
    <input type="hidden" th:field="*{nonce}">
    <input type="hidden" th:field="*{responseMode}">
    <input type="hidden" th:field="*{redirectUriSet}">
    <input type="hidden" th:field="*{openid}">
</form>
</body>
</html>